
import cv2
import numpy as np
from matplotlib import pyplot as plt

def Linear_Regression():
    # a = np.array([[14410,15452,14988,13293,15043,16954,17648,11750,12832,12774,13750,12839,14226,12204,13840,12176,12637,12889,14176,12759]]).T
    # m = np.array([[25.82,28.93,25.26,22.61,30.29,33.96,39.99,20.29,22.36,21.65,21.1,23.56,25.72,20.11,24.53,20.16,22.34,22.06,29.09,23.09]]).T
    # a = np.array([[14410,15452,14988,13293,15043,16954,17648,11750,12832,12774,13750,12839,14226,12204,13840,12176,12637,12889,14176,12759,12622,11839,13752,11910,13073,13270,12419,13584,15348,14160,14830,14322,14721,16721,12005,14746,15723,13404,14016,15043,16693,16179]]).T
    # m = np.array([[25.82,28.93,25.26,22.61,30.29,33.96,39.99,20.29,22.36,21.65,21.1,23.56,25.72,20.11,24.53,20.16,22.34,22.06,29.09,23.09,23.92,21.23,26.38,22.23,23.99,23.52,22.53,24.8,29.02,24.33,28.17,25.84,26.56,34.2,19.9,28.71,29.12,26.18,28.05,31.04,36,31.14]]).T
    a = np.array([[14410,15452,14988,13293,15043,16954,17648,11750,12832,12774,13750,12839,14226,12204,13840,12176,12637,12889,14176,12759,12622,11839,13752,11910,13073,13270,12419,13584,15348,14160,14830,14322,14721,16721,12005,14746,15723,13404,14016,15043,16693,16179,15913,15232,15128,13958,13466,15644,16517,13110,13397]]).T
    m = np.array([[25.82,28.93,25.26,22.61,30.29,33.96,39.99,20.29,22.36,21.65,21.1,23.56,25.72,20.11,24.53,20.16,22.34,22.06,29.09,23.09,23.92,21.23,26.38,22.23,23.99,23.52,22.53,24.8,29.02,24.33,28.17,25.84,26.56,34.2,19.9,28.71,29.12,26.18,28.05,31.04,36,31.14,33.03,31.45,27.96,24.78,23.23,31.44,31.61,22.2,21.35]]).T
    one = np.ones((a.shape[0],1))
    one = np.ones((a.shape[0],1))
    Xbar = np.concatenate((one,a),axis=1)
    A = np.dot(Xbar.T, Xbar)
    b = np.dot(Xbar.T, m)
    w = np.dot(np.linalg.pinv(A), b)
    print(a.size)

    ######################
    w_0 = w[0][0]
    w_1 = w[1][0]
    x0 = np.linspace(11000, 19000, 2)
    y0 = w_0 + w_1*x0
    plt.plot(a, m, 'ro')
    # plt.plot(x0, y0)
    # plt.axis([11000, 19000, 0, 50])
    # plt.title('Data on the weight of shrimp')
    # plt.xlabel('Area (pixel)')
    # plt.ylabel('Weight (g)')
    # plt.show()


    return w
if __name__ == "__main__":
    w = Linear_Regression()
    w_0 = w[0][0]
    w_0 = round(w_0, 5)
    w_1 = w[1][0]
    w_1 = round(w_1, 5)
    
    print(w_0)
    print(w_1)
    